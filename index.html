<!DOCTYPE html>
<html manifest="cache.manifest">
<head>
	<meta charset="utf-8" />
	<title>html manifest</title>
	<link rel="stylesheet" href="style.css" type="text/css" media="screen" />
</head>
<body>
	<div id="text"></div>

	<script type="text/javascript" src="cache.js"></script>
	<script type="text/javascript">
		var html = document.getElementById("text");

		var cache = window.applicationCache;
		//console.log('test:' + test);  //cache.js定义的一个变量，初始值为10

		html.innerHTML = "test:" + test;

		console.log(cache.status);

		function load(url, callback){
			var script = document.createElement('script');
			script.src = url;
			script.onload = function(){
				callback && callback();
			}
			document.body.appendChild(script);
		}

		setTimeout(function(){
			cache.addEventListener('updateready', function(){
				cache.swapCache();
				load('cache.js', function(){
			    	//log('test:' + test);    //test: 10
			    	html.innerHTML = "two:"+test;
				});    
			});
			cache.update();
		}, 20000);
	</script>
</body>
</html>
